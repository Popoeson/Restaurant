<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Order Confirmation - TastyBite</title>
<style>
  body {
    font-family: "Poppins", sans-serif;
    background: #fff8f2;
    color: #333;
    margin: 0;
    padding: 0;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    min-height: 100vh;
  }

  .confirmation-container {
    background: #fff;
    width: 95%;
    max-width: 520px;
    margin: 40px auto;
    border-radius: 25px;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.12);
    padding: 30px 25px;
    text-align: center;
    position: relative;
  }

  .confirmation-container::before {
    font-size: 50px;
    position: absolute;
    top: -25px;
    left: 50%;
    transform: translateX(-50%);
  }

  .success-icon {
    font-size: 70px;
    color: #28a745;
    margin-bottom: 15px;
  }

  h1 {
    color: #ff7b00;
    font-size: 28px;
    margin-bottom: 10px;
  }

  p {
    font-size: 16px;
    margin-bottom: 15px;
  }

  .order-id {
    background: #fff4e5;
    border-radius: 12px;
    padding: 12px;
    font-size: 16px;
    color: #ff7b00;
    font-weight: 600;
    margin: 15px 0;
    word-break: break-word;
  }

  .order-summary {
    text-align: left;
    background: #fff7f0;
    border-radius: 15px;
    padding: 20px;
    margin-top: 20px;
    box-shadow: inset 0 2px 5px rgba(0,0,0,0.03);
  }

  .order-summary h3 {
    margin-top: 0;
    color: #ff7b00;
    font-size: 20px;
    border-bottom: 1px solid #ffbb80;
    padding-bottom: 8px;
    margin-bottom: 15px;
  }

  .pack-title {
    font-weight: 600;
    color: #ff6600;
    margin-top: 10px;
    font-size: 16px;
  }

  .order-item {
    display: flex;
    justify-content: space-between;
    font-size: 15px;
    margin-bottom: 8px;
    padding: 5px 0;
    border-bottom: 1px dashed rgba(0,0,0,0.05);
  }

  .order-total {
    border-top: 2px solid #ffbb80;
    padding-top: 12px;
    font-weight: bold;
    color: #ff7b00;
    text-align: right;
    font-size: 18px;
    margin-top: 10px;
  }

  button {
    background: #ff7b00;
    color: #fff;
    border: none;
    border-radius: 12px;
    padding: 14px;
    font-size: 16px;
    margin-top: 25px;
    cursor: pointer;
    transition: 0.3s;
    width: 100%;
  }

  button:hover {
    background: #e86f00;
  }

  .note {
    margin-top: 12px;
    font-size: 13px;
    color: #666;
  }

  @media(max-width:480px){
    .confirmation-container { padding: 25px 15px; }
    h1 { font-size: 24px; }
    .order-summary h3 { font-size: 18px; }
  }

  /* ---------- FOOTER ---------- */
.footer {
  background-color: #111827; /* dark navy */
  color: #f5f5f5;
  padding: 50px 6% 25px;
  font-family: "Poppins", sans-serif;
  margin-top: 10px;
}

.footer-container {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 30px;
  margin-bottom: 25px;
}

.footer-about h3 {
  color: #ff6600;
  font-size: 1.4rem;
  margin-bottom: 10px;
}

.footer-about p {
  color: #ddd;
  line-height: 1.6;
}

.footer-hours h4,
.footer-contact h4 {
  color: #fff;
  font-size: 1.1rem;
  margin-bottom: 10px;
}

.footer-hours p,
.footer-contact p {
  color: #ccc;
  margin: 6px 0;
  font-size: 0.95rem;
}

.footer-hours span,
.footer-contact span {
  color: #ff6600;
  margin-right: 6px;
}

.footer-bottom {
  text-align: center;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  padding-top: 12px;
  font-size: 0.9rem;
  color: #aaa;
}

@media (max-width: 600px) {
  .footer {
    text-align: center;
  }
  .footer-hours p,
  .footer-contact p {
    margin-left: 0 !important;
  }
    }
</style>
</head>
<body>
<div class="confirmation-container" id="confirmation-container">
  <div class="success-icon">‚úÖ</div>
  <h1>Order Confirmed!</h1>
  <p>Thank you for your order, <span id="customerName"></span> üéâ</p>
  <p>Your food will arrive in approximately <b>30‚Äì45 minutes</b>.</p>

  <div class="order-id">
    Order ID: <span id="orderId"></span>
  </div>

  <div class="order-summary">
    <h3>Order Summary</h3>
    <div id="orderItems"></div>
    <div class="order-total" id="orderTotal"></div>
  </div>

  <p class="note">Keep your Order ID safe ‚Äî the dispatcher will confirm it upon delivery.</p>

  <button id="backHomeBtn">Back to Home</button>

  <footer class="footer">
  <div class="footer-container">
    <div class="footer-about">
      <h3>Tasty Bites</h3>
      <p>Delicious food made with the freshest ingredients, delivered right to your table.</p>
    </div>

    <div class="footer-hours">
      <h4>Hours</h4>
      <p><span>üïí</span> Monday - Friday: 11am - 10pm</p>
      <p style="margin-left: 22px;">Saturday - Sunday: 10am - 11pm</p>
    </div>

    <div class="footer-contact">
      <h4>Contact</h4>
      <p><span>üìû</span> (123) 456-7890</p>
      <p><span>üìç</span> 123 Main Street, Cityville, State 12345</p>
    </div>
  </div>

  <div class="footer-bottom">
    <p>¬© 2025 Tasty Bites. All rights reserved.</p>
  </div>
  </footer>
</div>

<script>
document.addEventListener("DOMContentLoaded", async () => {
  const orderRef = localStorage.getItem("lastOrderID");
  const container = document.getElementById("confirmation-container");
  const customerNameEl = document.getElementById("customerName");
  const orderIdEl = document.getElementById("orderId");
  const orderItemsContainer = document.getElementById("orderItems");
  const totalAmountEl = document.getElementById("orderTotal");

  if (!orderRef) {
    container.innerHTML = "<p>No order reference found. Please go back to the homepage.</p>";
    return;
  }

  try {
    const response = await fetch(`https://restaurant-eqbo.onrender.com/api/orders/${orderRef}`);
    if (!response.ok) throw new Error("Order not found");
    const order = await response.json();

    customerNameEl.textContent = order.name || "Customer";
    orderIdEl.textContent = order.reference || orderRef;
    orderItemsContainer.innerHTML = "";

    order.items.forEach(pack => {
      Object.keys(pack).forEach(packName => {
        const packItems = pack[packName];

        const packTitle = document.createElement("div");
        packTitle.classList.add("pack-title");
        packTitle.textContent = packName;
        orderItemsContainer.appendChild(packTitle);

        if (Array.isArray(packItems)) {
          packItems.forEach(item => {
            const div = document.createElement("div");
            div.classList.add("order-item");
            div.innerHTML = `
              <div>${item.name} √ó ${item.qty}</div>
              <div>‚Ç¶${(item.price * item.qty).toLocaleString()}</div>
            `;
            orderItemsContainer.appendChild(div);
          });
        }
      });
    });

    totalAmountEl.textContent = `Total: ‚Ç¶${order.totalAmount?.toLocaleString() || 0}`;
  } catch (err) {
    console.error("Error loading order:", err);
    container.innerHTML = `<p>‚ùå ${err.message}</p>`;
  }

  document.getElementById("backHomeBtn").addEventListener("click", () => {
    localStorage.removeItem("cart");
    localStorage.removeItem("orderReference");
    window.location.href = "index.html";
  });
});
</script>
</body>
</html>
